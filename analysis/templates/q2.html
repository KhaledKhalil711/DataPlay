{% load static %}
<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>DataPlay - Co√ªt des Jeux</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'styles.css' %}" />
  </head>
  <body>
    <header class="header">
      <div class="container">
        <div class="logo-container">
          <a href="{% url 'home' %}" class="logo-button">
            <h1 class="logo-text">DataPlay</h1>
          </a>
        </div>
        <nav class="nav">
          <a href="{% url 'home' %}" class="nav-link">Accueil</a>
          
          {% if user.is_authenticated %}
            <span class="nav-link" style="color: var(--accent-blue);">Bonjour, {{ user.first_name }}!</span>
            <form method="post" action="{% url 'logout' %}" style="margin: 0; display: inline;">
              {% csrf_token %}
              <button type="submit" class="nav-link">D√©connexion</button>
            </form>
          {% endif %}
        </nav>
      </div>
    </header>

    <section class="features">
      <div class="container">
        <h2 class="section-title">Analyse des Prix</h2>

        <!-- Statistics Cards -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
          <div class="insight-card" style="text-align: center;">
            <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem;">üìä Prix M√©dian</h4>
            <p style="font-size: 2rem; font-weight: bold; color: var(--text-white); margin: 0;">‚Ç¨{{ stats.median_price|floatformat:2 }}</p>
          </div>
          
          <div class="insight-card" style="text-align: center;">
            <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem;">üíµ Prix Moyen</h4>
            <p style="font-size: 2rem; font-weight: bold; color: var(--text-white); margin: 0;">‚Ç¨{{ stats.average_price|floatformat:2 }}</p>
          </div>
          
          <div class="insight-card" style="text-align: center;">
            <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem;">üéÆ Jeux Gratuits</h4>
            <p style="font-size: 2rem; font-weight: bold; color: var(--text-white); margin: 0;">{{ stats.free_games|floatformat:0 }}</p>
          </div>
          
          <div class="insight-card" style="text-align: center;">
            <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem;">‚úÖ Sous 10‚Ç¨</h4>
            <p style="font-size: 2rem; font-weight: bold; color: var(--text-white); margin: 0;">{{ stats.percent_under_10|floatformat:0 }}%</p>
          </div>
        </div>

        <!-- Chart 1: Histogram -->
        {{ chart1|safe }}
        
        <div class="insight-card">
          <h4>Enseignements cl√©s : Jeux Payants</h4>
          <ul class="insight-list">
            <li>
              La plupart des jeux ind√©pendants payants sont propos√©s √† un prix
              <strong>inf√©rieur √† 10 ‚Ç¨</strong>.
            </li>
            <li>
              La plus forte concentration de prix se situe dans la tranche
              allant de <strong>0 ‚Ç¨ √† 4,99 ‚Ç¨</strong>.
            </li>
            <li>
              La fr√©quence des prix <strong>chute brutalement</strong> apr√®s le
              seuil des 20 ‚Ç¨.
            </li>
            <li>
              Les jeux ind√©s √† prix √©lev√© (30 ‚Ç¨ et plus) sont
              <strong>tr√®s rares</strong> sur le march√©.
            </li>
            <li>
              La distribution des prix pr√©sente une
              <strong>asym√©trie positive</strong> (vers la droite), indiquant
              l'existence de quelques exceptions co√ªteuses.
            </li>
          </ul>
          <p class="insight-note">
            üí° L'histogramme montre que le march√© ind√© est ultra-comp√©titif sur
            les petits prix. Passez votre souris sur le graphique pour voir les d√©tails!
          </p>
        </div>

        <!-- Chart 2: Price Buckets -->
        {{ chart2|safe }}

        <div class="insight-card">
          <h4>Enseignements cl√©s : Tranches de Prix (Gratuit + Payant)</h4>
          <ul class="insight-list">
            <li>
              Une part importante des jeux ind√©pendants est propos√©e en
              <strong>Free-to-play</strong> (gratuit).
            </li>
            <li>
              Les <strong>prix abordables</strong> dominent largement l'ensemble
              du march√© ind√©pendant.
            </li>
            <li>
              Les jeux vendus au-del√† de 20 ‚Ç¨ ne repr√©sentent qu'une
              <strong>infime fraction</strong> des sorties totales.
            </li>
            <li>
              Les d√©veloppeurs privil√©gient des
              <strong>points d'entr√©e √† bas prix</strong> pour attirer plus
              facilement les joueurs.
            </li>
            <li>
              Les jeux ind√©s au prix "Premium" constituent
              <strong>l'exception et non la r√®gle</strong>.
            </li>
          </ul>
          <p class="insight-note">
            üí° Ce graphique confirme que l'accessibilit√© financi√®re est une
            strat√©gie cl√© pour les studios ind√©s.
          </p>
        </div>

        <!-- Back Button -->
        <div style="text-align: center; margin-top: 3rem;">
          <a href="{% url 'home' %}" class="show-charts-btn" style="display: inline-flex;">
            <span>‚Üê Retour √† l'accueil</span>
          </a>
        </div>
      </div>
    </section>
  </body>
</html>