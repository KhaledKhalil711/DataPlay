{% load static %}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <title>DataPlay - Genres et Tags Populaires</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="{% static 'styles.css' %}" />
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="logo-container">
                <a href="{% url 'home' %}" class="logo-button">
                    <h1 class="logo-text">DataPlay</h1>
                </a>
            </div>
            <nav class="nav">
                <a href="{% url 'home' %}" class="nav-link">Accueil</a>
                
                
                {% if user.is_authenticated %}
                    <span class="nav-link" style="color: var(--accent-blue);">Bonjour, {{ user.first_name }}!</span>
                    <form method="post" action="{% url 'logout' %}" style="margin: 0; display: inline;">
                        {% csrf_token %}
                        <button type="submit" class="nav-link">DÃ©connexion</button>
                    </form>
                {% endif %}
            </nav>
        </div>
    </header>

    <section class="features">
        <div class="container">
            <h2 class="section-title">ğŸ“Š Genres et Tags Populaires</h2>

            <!-- Statistics Cards -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
                <div class="insight-card" style="text-align: center; background: var(--card-bg); padding: 1.5rem; border-radius: 15px; border: 1px solid var(--card-border);">
                    <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem; font-size: 0.95rem;">ğŸ® Genres AnalysÃ©s</h4>
                    <p style="font-size: 2rem; font-weight: bold; color: var(--text-white); margin: 0;">{{ stats.total_genres }}</p>
                </div>
                
                <div class="insight-card" style="text-align: center; background: var(--card-bg); padding: 1.5rem; border-radius: 15px; border: 1px solid var(--card-border);">
                    <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem; font-size: 0.95rem;">ğŸ·ï¸ Tags Uniques</h4>
                    <p style="font-size: 2rem; font-weight: bold; color: var(--text-white); margin: 0;">{{ stats.total_tags }}</p>
                </div>
                
                <div class="insight-card" style="text-align: center; background: var(--card-bg); padding: 1.5rem; border-radius: 15px; border: 1px solid var(--card-border);">
                    <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem; font-size: 0.95rem;">ğŸ”¥ Genre #1</h4>
                    <p style="font-size: 1.5rem; font-weight: bold; color: var(--text-white); margin: 0;">{{ stats.most_popular_genre }}</p>
                    <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 0.5rem;">{{ stats.top_genre_count|floatformat:0 }} jeux</p>
                </div>
                
                <div class="insight-card" style="text-align: center; background: var(--card-bg); padding: 1.5rem; border-radius: 15px; border: 1px solid var(--card-border);">
                    <h4 style="color: var(--accent-blue); margin-bottom: 0.5rem; font-size: 0.95rem;">â­ Tag #1</h4>
                    <p style="font-size: 1.5rem; font-weight: bold; color: var(--text-white); margin: 0;">{{ stats.most_popular_tag }}</p>
                    <p style="font-size: 0.9rem; color: var(--text-light); margin-top: 0.5rem;">{{ stats.top_tag_count|floatformat:0 }} jeux</p>
                </div>
            </div>

            <!-- Chart 1: Genre Popularity (Weighted by Engagement) -->
            <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 15px; padding: 2rem; margin-bottom: 2rem;">
                {{ chart1|safe }}
            </div>
            
            <div class="insight-card">
                <h4>ğŸ’¡ Points ClÃ©s : Engagement par Genre</h4>
                <ul class="insight-list">
                    <li>
                        Le genre <strong>{{ stats.most_engaged_genre }}</strong> domine en termes d'engagement joueur
                    </li>
                    <li>
                        L'engagement est mesurÃ© par le <strong>nombre total de reviews</strong>, 
                        reflÃ©tant l'intÃ©rÃªt rÃ©el des joueurs
                    </li>
                    <li>
                        Les 3 genres en tÃªte (en surbrillance cyan) reprÃ©sentent la majoritÃ© de l'activitÃ©
                    </li>
                    <li>
                        Certains genres nichÃ©s ont peu de reviews malgrÃ© un nombre de jeux consÃ©quent
                    </li>
                    <li>
                        Cette mÃ©trique est plus rÃ©vÃ©latrice que le simple nombre de jeux disponibles
                    </li>
                </ul>
                <p class="insight-note">
                    ğŸ’¡ Ce graphique pondÃ¨re par l'engagement - un genre avec moins de jeux mais trÃ¨s 
                    populaires peut surpasser un genre avec beaucoup de jeux peu jouÃ©s. 
                    Survolez les barres pour voir les dÃ©tails!
                </p>
            </div>

            <!-- Chart 2: Genre Popularity by Count -->
            <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 15px; padding: 2rem; margin: 3rem 0 2rem 0;">
                {{ chart2|safe }}
            </div>

            <div class="insight-card">
                <h4>ğŸ’¡ Points ClÃ©s : PopularitÃ© par Nombre de Jeux</h4>
                <ul class="insight-list">
                    <li>
                        <strong>{{ stats.most_popular_genre }}</strong> est le genre le plus reprÃ©sentÃ© 
                        avec {{ stats.top_genre_count|floatformat:0 }} jeux
                    </li>
                    <li>
                        Cette vue montre la <strong>diversitÃ© de l'offre</strong> par genre
                    </li>
                    <li>
                        Certains genres sont sur-reprÃ©sentÃ©s, reflÃ©tant les tendances de dÃ©veloppement
                    </li>
                    <li>
                        Les genres de niche ont souvent moins de titres mais des communautÃ©s fidÃ¨les
                    </li>
                    <li>
                        La barre cyan indique le genre avec le plus grand catalogue de jeux
                    </li>
                </ul>
                <p class="insight-note">
                    ğŸ’¡ Comparez ce graphique avec le prÃ©cÃ©dent : un grand nombre de jeux 
                    ne garantit pas forcÃ©ment un engagement Ã©levÃ©!
                </p>
            </div>

            <!-- Chart 3: Top 20 Tags -->
            <div style="background: var(--card-bg); border: 1px solid var(--card-border); border-radius: 15px; padding: 2rem; margin: 3rem 0 2rem 0;">
                {{ chart3|safe }}
            </div>

            <div class="insight-card">
                <h4>ğŸ’¡ Points ClÃ©s : Tags Populaires</h4>
                <ul class="insight-list">
                    <li>
                        Le tag <strong>"{{ stats.most_popular_tag }}"</strong> apparaÃ®t sur 
                        {{ stats.top_tag_count|floatformat:0 }} jeux
                    </li>
                    <li>
                        Les tags reflÃ¨tent les <strong>caractÃ©ristiques gameplay</strong> 
                        plutÃ´t que les genres traditionnels
                    </li>
                    <li>
                        Les 5 tags en tÃªte (cyan) sont prÃ©sents sur la majoritÃ© des jeux indie
                    </li>
                    <li>
                        Les tags permettent une <strong>catÃ©gorisation plus fine</strong> que les genres
                    </li>
                    <li>
                        Certains tags comme "2D", "Singleplayer" sont trÃ¨s transversaux
                    </li>
                </ul>
                <p class="insight-note">
                    ğŸ’¡ Les tags sont assignÃ©s par la communautÃ© Steam et reflÃ¨tent 
                    la perception rÃ©elle des joueurs. Un jeu peut avoir plusieurs tags!
                </p>
            </div>

            <!-- Summary Insight -->
            <div class="insight-card" style="margin-top: 3rem; background: linear-gradient(135deg, rgba(30, 144, 255, 0.15), rgba(0, 212, 255, 0.15)); border: 2px solid var(--accent-blue);">
                <h4 style="color: var(--accent-blue); font-size: 1.3rem;">ğŸ¯ SynthÃ¨se de l'Analyse</h4>
                <ul class="insight-list">
                    <li>
                        <strong>DiversitÃ©</strong> : {{ stats.total_genres }} genres et {{ stats.total_tags }} tags 
                        montrent la richesse de l'Ã©cosystÃ¨me indie
                    </li>
                    <li>
                        <strong>Concentration</strong> : Quelques genres/tags dominent largement le marchÃ©
                    </li>
                    <li>
                        <strong>Engagement vs QuantitÃ©</strong> : Le nombre de jeux ne prÃ©dit pas l'engagement joueur
                    </li>
                    <li>
                        <strong>OpportunitÃ©s</strong> : Les genres de niche offrent moins de concurrence
                    </li>
                    <li>
                        <strong>Tendances</strong> : Les tags rÃ©vÃ¨lent les mÃ©caniques de gameplay prÃ©fÃ©rÃ©es
                    </li>
                </ul>
            </div>

            <!-- Back Button -->
            <div style="text-align: center; margin-top: 3rem;">
                <a href="{% url 'home' %}" class="show-charts-btn" style="display: inline-flex;">
                    <span>â† Retour Ã  l'accueil</span>
                </a>
            </div>
        </div>
    </section>
</body>
</html>